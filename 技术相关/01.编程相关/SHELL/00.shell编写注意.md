- 可以借用 shellcheck 工具检查一些基本的shell缺陷 https://github.com/koalaman/shellcheck
-



for i in {1..3600};do
    date >> /db_backup/tmp/pg_stat_activity/detail.log
    psql -d postgres -p postgres -p 3434 -c "select count(*) from pg_stat_activity" >> /db_backup/tmp/pg_stat_activity/detail.log
    psql -d postgres -p postgres -p 3434 -c "select count(*), application_name from pg_stat_activity group by application_name;" >> /db_backup/tmp/pg_stat_activity/detail.log
    psql -d postgres -p postgres -p 3434 -c "select count(*), client_addr from pg_stat_activity group by client_addr;" >> /db_backup/tmp/pg_stat_activity/detail.log
    sleep 10
done