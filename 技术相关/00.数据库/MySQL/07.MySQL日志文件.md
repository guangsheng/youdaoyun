### 更改MySQL日志的运行日志和二进制日志目录

### 日志类型
#### 错误日志
记录启动、运行或停止mysqld时出现的问题。

#### 查询日志
记录建立的客户端连接和执行的语句。

#### 更新日志
记录更改数据的语句。不赞成使用该日志。

#### 二进制日志
记录所有更改数据的语句。还用于复制。

#### 慢日志
记录所有执行时间超过long_query_time秒的所有查询或不使用索引的查询。


### 日志刷新
默认情况下，所有日志创建于mysqld数据目录中。通过刷新日志，你可以强制 mysqld来关闭和重新打开日志文件（或者在某些情况下切换到一个新的日志）。当你执行一个FLUSH LOGS语句或执行mysqladmin flush-logs或mysqladmin refresh时，出现日志刷新。

### 二进制日志
1. 类似于PostgreSQL的预写日志，更像Oracle的归档日志
2. mysqld在每个二进制日志名后面添加一个数字扩展名。每次你启动服务器或刷新日志时该数字则增加。如果当前的日志大小达到max_binlog_size，还会自动创建新的二进制日志。如果你正使用大的事务，二进制日志还会超过max_binlog_size：事务全写入一个二进制日志中，绝对不要写入不同的二进制日志中。
3. 为了能够知道还使用了哪个不同的二进制日志文件，mysqld还创建一个二进制日志索引文件，包含所有使用的二进制日志文件的文件名。
4. 可以用RESET MASTER语句删除所有二进制日志文件，或用PURGE MASTER LOGS只删除部分二进制文件。
5. 配置参数
    + --binlog-do-db=db_name
    告诉主服务器，如果当前的数据库(即USE选定的数据库)是db_name，应将更新记录到二进制日志中。其它所有没有明显指定的数据库  被忽略。如果使用该选项，你应确保只对当前的数据库进行更新。
    + --binlog-ignore-db=db_name
    告诉主服务器，如果当前的数据库(即USE选定的数据库)是db_name，不应将更新保存到二进制日志中。如果你使用该选项，你应确保只对当前的数据库进行更新


### 和PostgreSQL的区别
运行日志不能指定按日期或大小分文件，需要自己用脚本实现，可以参考MySQL为RedHat提供的mysql-log-rotate

### 相关参数
+ 错误日志：log_error[=file_name]
+ 通用查询日志：general_log=[0|1]  general_log_file=[file_name]
+ 二进制日志：log_bin[=file_name]    log_bin_index[=file_name]
+ 慢速查询日志：slow_query_log[={0|1}]     slow_query_log_file=file_name

### 实际例子  在$MYSQLHOME下创建my.cnf
```
[mysqld]
log_error = ../mysql_log/run_log/mysqlrun.err

general_log=1
general_log_file=../mysql_log/run_log/mysqlrun.log

slow_query_log=1
slow_query_log_file=../mysql_log/run_log/mysqlrunslow.log

server_id=101
log_bin=../mysql_log/bin_log/mysqlbin
log_bin_index=../mysql_log/bin_log/mysqlbin.index
```
### 除和innodb外其他的log相关参数
```
+-----------------------------------------+-------------------------------------------------+
| Variable_name                           | Value                                           |
+-----------------------------------------+-------------------------------------------------+
| back_log                                | 80                                              |
| binlog_cache_size                       | 32768                                           |
| binlog_checksum                         | CRC32                                           |
| binlog_direct_non_transactional_updates | OFF                                             |
| binlog_error_action                     | ABORT_SERVER                                    |
| binlog_format                           | ROW                                             |
| binlog_group_commit_sync_delay          | 0                                               |
| binlog_group_commit_sync_no_delay_count | 0                                               |
| binlog_gtid_simple_recovery             | ON                                              |
| binlog_max_flush_queue_time             | 0                                               |
| binlog_order_commits                    | ON                                              |
| binlog_row_image                        | FULL                                            |
| binlog_rows_query_log_events            | OFF                                             |
| binlog_stmt_cache_size                  | 32768                                           |
| expire_logs_days                        | 0                                               |
| general_log                             | ON                                              |
| general_log_file                        | ../mysql_log/run_log/mysqlrun.log               |
| log_bin                                 | ON                                              |
| log_bin_basename                        | ../mysql_log/bin_log/mysqlbin                   |
| log_bin_index                           | ../mysql_log/bin_log/mysqlbin.index             |
| log_bin_trust_function_creators         | OFF                                             |
| log_bin_use_v1_row_events               | OFF                                             |
| log_builtin_as_identified_by_password   | OFF                                             |
| log_error                               | /usr/local/mysql/mysql_log/run_log/mysqlrun.err |
| log_error_verbosity                     | 3                                               |
| log_output                              | FILE                                            |
| log_queries_not_using_indexes           | OFF                                             |
| log_slave_updates                       | OFF                                             |
| log_slow_admin_statements               | OFF                                             |
| log_slow_slave_statements               | OFF                                             |
| log_statements_unsafe_for_binlog        | ON                                              |
| log_syslog                              | OFF                                             |
| log_syslog_facility                     | daemon                                          |
| log_syslog_include_pid                  | ON                                              |
| log_syslog_tag                          |                                                 |
| log_throttle_queries_not_using_indexes  | 0                                               |
| log_timestamps                          | UTC                                             |
| log_warnings                            | 2                                               |
| max_binlog_cache_size                   | 18446744073709547520                            |
| max_binlog_size                         | 1073741824                                      |
| max_binlog_stmt_cache_size              | 18446744073709547520                            |
| max_relay_log_size                      | 0                                               |
| relay_log                               |                                                 |
| relay_log_basename                      | /usr/local/mysql/data/bogon-relay-bin           |
| relay_log_index                         | /usr/local/mysql/data/bogon-relay-bin.index     |
| relay_log_info_file                     | relay-log.info                                  |
| relay_log_info_repository               | FILE                                            |
| relay_log_purge                         | ON                                              |
| relay_log_recovery                      | OFF                                             |
| relay_log_space_limit                   | 0                                               |
| slow_query_log                          | ON                                              |
| slow_query_log_file                     | ../mysql_log/run_log/mysqlrunslow.log           |
| sql_log_bin                             | ON                                              |
| sql_log_off                             | OFF                                             |
| sync_binlog                             | 1                                               |
| sync_relay_log                          | 10000                                           |
| sync_relay_log_info                     | 10000                                           |
+-----------------------------------------+-------------------------------------------------+
```
