可以使用API setnx实现分布式锁，setnx意思是set if not exist， 如果setnx成功返回1，说明获得锁，当程序执行完成后删除键到达释放锁的目的，如果setnx失败返回0，说明未获得锁，可通过循环等待继续获取  

如果程序获得锁后，断开了与Redis的连接，锁未进行释放，则程序发生死锁。解决办法是获得锁时，将值设置为锁的超时时间（当前时间+锁有效时间），其它线程获取锁时，判断当前时间是否大于超时时间，如果大于先删除锁的键，再使用setnx更新对应的值。但是当两个线程同时删除锁的键时，还是会发生并发问题，所以需使用API getset，getset在设置值的同时会先返回旧值，通过比较旧值是否小于当前时间来判断程序是否可以获得锁  